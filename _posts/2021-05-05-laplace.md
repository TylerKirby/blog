---
keywords: fastai
description: Bayesian machine learning often requires working with posterior distributions that have no known closed form. There are plenty of approximation methods that exist, though they tend to be quite complex. This post provides an overview of the Laplace Approximation, an exceptionally simple approach that is seeing a resurgence in recent deep learning papers.
title: Laplace Approximation
toc: true
comments: true
categories: [machine_learning]
nb_path: _notebooks/2021-05-05-laplace.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-05-05-laplace.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Deep neural networks continue to solve problems that seemed out of reach of machine learning everyday. They offer unprecedented ability to generalize on high dimensional non-linear data and show promise in applications as far reaching as self-driving cars and automated radiological analysis. But as they are applied to high stakes problems like driving on the freeway and medical prognosis, limitations inherit to traditional deep learning algorithms like the inability to compute meaningful confidence scores easily and in a principled way become more clear. Bayesian neural networks seek to redress this by using proven probability methods to quantify uncertainty associated with inference. Unfortunately, these methods are usually much more mathematically complex and computationally intensive since they require working directly with continuous probability distributions. Recent research, however, has shown promising results by applying simpler techniques to modern neural networks like the Neurips 2021 paper, Laplace Redux - Effortless Bayesian Deep Learning, that utilizes the Laplace Approximation for fast and easy uncertainty estimates. This particular paper caught my eye since the Laplace Approximation was one of my favorite topics in graduate school. Most techniques for approximating posteriors are quite laborious and mathematically dense, but the Laplace Approximation is elegant in its simplicity and has found wide usage in standard implementations of key algorithms like Gaussian Process Classification. In this post I’ll review what the Neurips paper assumes the reader knows - why we need to approximate posteriors, how the Laplace Approximation generally works, and the importance of carefully implementations. The Laplace Approximation is an invaluable tool in the Bayesian toolbox and with this new paper it has become even more so.</p>
<h2 id="Problematic-Posteriors">Problematic Posteriors<a class="anchor-link" href="#Problematic-Posteriors"> </a></h2><p>To better appreciate the utility of the Laplace Approximation, let’s consider some instances where it can be useful. Suppose we would like to use logistic regression in an instance where uncertainty estimates are crucial, e.g., a binary classifier of radiological data that determines whether a tumor is benign or cancerous. A positive result indicating that a tumor is in fact cancerous is a serious affair, so we should have an understanding as to how certain we are about the prognosis. We can use Bayes’ Theorem to formulate the problem appropriately. Logistic regression is a parametric model for classification, so our prior belief should relate to the weights and our likelihood should define the relationship between the inputs and outputs of our model. A reasonable prior belief for our weights is that they are Gaussian distributed. Since this is a binary classification problem, we want to constrain our output space to just 0 and 1 which means that both Bernoulli and Binomial distributions are candidates for our likelihood. No matter our choice, however, our posterior belief will be intractable since Gaussian priors are not conjugate with either Bernoulli or Binomial distributions.</p>
<p>Suppose that after feeding our data to this logistic model we draw samples from the posterior which looks like this:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;Probability&#39;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The true closed form solution for the posterior above is {% fn 1 %}</p>
$$
p(z) = \exp(\frac{-z^2}{2}) \cdot (1 + \exp(-20z-4))^{-1}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unfortunately we will very rarely have direct access to the closed form solution for the posterior, so we must approximate. Enter: Pierre-Simon Laplace.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Solution-from-Parisian-Dice-Parlors">A Solution from Parisian Dice Parlors<a class="anchor-link" href="#A-Solution-from-Parisian-Dice-Parlors"> </a></h2><p>The Marquis de Laplace was a busy man. From his service to one Napoleon Bonaparte to his time frequenting gambling dens, there was no shortage of opportunities where Laplace needing to estimate the odds of an event. His contributions to the field of probability are almost unmatched: he rigorously formulated and popularized Bayes' Theorem, discovered probability generating functions, tied the least squares method to probability, and proved the central limit theorem which underpins the fields of statistics and probability today. But we are mostly concerned with a method developed in his 1774 manuscript <em>Mémoires de Mathématique et de Physique</em>.</p>
<h3 id="Deriving-the-Laplace-Approximation">Deriving the Laplace Approximation<a class="anchor-link" href="#Deriving-the-Laplace-Approximation"> </a></h3><p>The Laplace Approximation is a very general method for working with integrals of the form
$$
\int^a_b \exp(M \cdot f(x)) dx
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where $M$ is some large number and $f(x)$ is at least twice differentiable.</p>
<p>The basic idea is that we can use a Taylor series around the global maximum of the function as an approximation of the original intractable integral. Suppose that $f(x)$ has a global maximum around $x_0$ and that $x_0$ is not an endpoint. Then, using the first few terms of the Taylor series we have</p>
$$
f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{1}{2}f''(x_0)(x-x_0)^2
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Knowing that $f(x_0)$ is a global maximum allows us to simplify a bit further since $f'(x_0)$ should be 0.</p>
$$
f(x) \approx f(x_0) - \frac{1}{2}|f''(x_0)|(x-x_0)^2
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we plug this back into our original integral equation we have
$$
\int^a_b \exp(M \cdot f(x)) dx \approx \int^a_b \exp(M \cdot f(x_0) - \frac{1}{2}|f''(x_0)|(x-x_0)^2) dx
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which further simplifies to
$$
\exp(M f(x_0)) \cdot \int^a_b \exp(- \frac{1}{2}|f''(x_0)|(x-x_0)^2) dx
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall that the Gaussian integral has the form</p>
$$
\int \exp(-x)^2 dx = \sqrt{pi}
$$<p>so assuming that the integral we're interested in is an indefinite integral as is the case with most probability density functions then the Laplace Approximation allows us to use the Gaussian integral as an approximation. Using the Gaussian integral we can reduce the above equation into the final formulation of Laplace Approximation:</p>
$$
\int^a_b \exp(M \cdot f(x)) dx \approx \sqrt{\frac{2 \pi}{M |f''(x_0)|)}}\exp(Mf(x_0))
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which improves in accuracy as $M \rightarrow \infty$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="A-Simple-Application">A Simple Application<a class="anchor-link" href="#A-Simple-Application"> </a></h3><p>As a brief aside, let's consider an application of the Laplace Approximation to a computer science problem. Suppose you wished to write a program to quickly compute $f(n) = n!$. Factorial equations are used all throughout physics, probability, and mathematics with practical uses in computing Bézier curves for computer graphics and time complexity equations for sorting algorithms.</p>
<p>A naive solution may look like</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">factorial</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>120</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we needed to run this function on very large integers thousands of times a second which may often be the case esperically in computer graphics, then we need this code to be especially fast. Multiplying increasing large integers in a for loop will probably become a bottleneck rather quickly, so this is a good opportunity to apply an approximation. Let's begin with the similar and useful Gamma function:</p>
$$
\Gamma(n) = (n-1)! = \int_0^{\infty} \exp(-x) x^{n-1} dx
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our factorial equation can then be written as</p>
$$
n! = \Gamma(n + 1) = \int_0^{\infty} \exp(-x)x^ndx
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By performing a change of variables so that $x = nz$ and $dx = n dz$ we can derive the following</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
= \int_0^{\infty} \exp(-nz) (nz)^n n dz \\
= n^{n+1} \int_0^{\infty} \exp(-nz)z^n dz \\
= n^{n+1} \int_0^{\infty} \exp(-nz) \exp(n \ln z) dz \\
= n^{n+1} \int_0^{\infty} \exp(n (\ln z - z)) dz
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note that the final integral above has the form required for the Laplace Approximation: $\int^a_b \exp(M \cdot f(x)) dx$ since $f(z) = \ln z - z$ is twice differentiable. Recall that as $M \rightarrow \infty$, the approximation is more accurate so our final approximation of the factorial equation above will be more accurate for larger choices of $n$.</p>
<p>Using the Laplace approximation, we arrive at Stirling's Approximation for computing factorials:</p>
$$
\int^a_b \exp(M \cdot f(x)) dx \approx \sqrt{\frac{2 \pi}{M |f''(x_0)|)}}\exp(Mf(x_0))\\
n^{n+1} \int_0^{\infty} \exp(n (\ln z - z)) dz \approx n^{n+1} \sqrt{\frac{2 \pi}{n |f''(x_0)|}}\exp(n f(x_0))
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$f(z) = \ln z - z$, so $f'(z) = \frac{1}{z} - 1$ and $f''(z) = -\frac{1}{z^2}$. The max of $f(z)$ is found at $z=1$, so $f(z_0=1) = -1$ and $f''(z_0 = 1) = -1$ as well. With this we arrive at the final approximation:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
n! \approx n^{n+1} \sqrt{\frac{2 \pi}{n}}e^{-n}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which in Python would be</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">stirling_approx</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">n</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">n</span><span class="p">)</span>
<span class="n">stirling_approx</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>118.01916795759008</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The error between the actual and approximation is</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">factorial</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">stirling_approx</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.08099564851101682</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Returning-to-Uncertainty">Returning to Uncertainty<a class="anchor-link" href="#Returning-to-Uncertainty"> </a></h2><p>Now that we've covered the mechanics of the Laplace Approximation and applied it to the simple factorial problem, let's return to the original context and see how this method applies to the original issue of approximating a posterior.</p>
<p>To approximate our posterior, we need to know 1) at which point the probability density function is maximized, i.e., the mode of the posterior and then 2) we need to evaluate that point with the second derivative of the probability density function. If we were approximating a multivariate distribution, this then becomes slightly more complex by requiring us to determine the Hessian matrix for the posterior.</p>
<p>Find the mode of a distribution is typically straightforward. If we are working in a model context like Bayesian logistic regression then we can typically compute the <em>maximum a posteriori</em> (MAP) estimate directly. Otherwise, we can sample the distribution to determine the mode. Note however that distributions of higher dimensions cannot be sampled efficiently so it is ideal generally to work in a known framework where MAP estimation is relatively easy.</p>
<p>Second derivatives and Hessians unfortunately are more difficult to determine though thankfully this is changing. When working in a known framework like Bayesian logistic regression then it is usually possible to find the necessary derivatives from the loss function either directly or with a numerical method like Newton's method. These tend to be quite compute expensive, but there have been a lot of recent advances that make this process much more efficient.{% fn 2 %}</p>
<p>Finally, let's take another look at that tricky posterior from earlier:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x11e0838e0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We essentially want to find a PDF $q(x)$ to approximate our unknown $p(x)$ above. In the context of continuous probability distributions, we typically prefer to work with the negative log likelihood since it is much easier to use in an optimization context. Let us revisit our derivation of the Laplace Approximation to consider the log likelihood $\ln p(x)$. The Taylor approximation is then
$$
\ln fp(x) \approx \ln fp(x_0) -\frac{1}{2} (-p''(x_0)) (x-x_0)^2
$$
Exponetiating the above leads to
$$
p(x) \approx p(x_0) \exp(-\frac{p''(x_0)}{2}(x-x_0)^2)
$$
Again recognizing that $\exp(-\frac{p''(x_0)}{2}(x-x_0)^2)$ is essentially an unnormalized Gaussian PDF, we can formulate the normalized Gaussian $q(x)$ that we can use to approximate our posterior:
$$
q(x) = \sqrt{\frac{-p''(x_0)}{2\pi}} \exp(-\frac{p''(x_0)}{2}(x-x_0)^2)
$$</p>
<p>Now we just need to compute the mode of the posterior $x_0$ and the term p''(x_0). Below we compute the mode by sampling the distribution. Note that this may not always be possible but in cases where the mode or $p''(x_0)$ cannot be found by sampling, we often have direct access to the loss function or posterior PDF from which can we derive a closed form solution for the Laplace approximation.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span>
<span class="n">max_x</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: -0.993141
         Iterations: 17
         Function evaluations: 34
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">max_point</span> <span class="o">=</span> <span class="mf">0.077</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we approximate $p''(x_0)$. For this example, we'll just use <code>scipy.misc.derivative</code> which is an implementation of the central difference equation for approximation.{% fn 3 %} Again this assumes we can sample the posterior directly.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.misc</span> <span class="kn">import</span> <span class="n">derivative</span>
<span class="k">def</span> <span class="nf">ln_p</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">max_x</span> <span class="o">=</span> <span class="n">scipy</span><span class="o">.</span><span class="n">optimize</span><span class="o">.</span><span class="n">fmin</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">p</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">approx_sec_deriv</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">derivative</span><span class="p">(</span><span class="n">ln_p</span><span class="p">,</span> <span class="n">max_x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">dx</span><span class="o">=</span><span class="mf">1e-6</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;p&#39;&#39;(x_0) &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">approx_sec_deriv</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Optimization terminated successfully.
         Current function value: -0.993141
         Iterations: 17
         Function evaluations: 34
p&#39;&#39;(x_0)  2.5426
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can finally plot our approximated Gaussian against the original posterior.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.legend.Legend at 0x126dca9a0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we can see, the approximated posterior is very close to the actual distribution.</p>
<p>We should note the flaws with this method though. Some of our approximations are quite expensive. Numerically determining the second derivative with the central difference equation for a single variable once may not be a big deal, but this will quickly become infeasible as we increase the dimensionality of the distribution. Additionally, if this was part of a larger model training loop, approximating a Hessian matrix every batch would be prohibatively expensive. For the multidimensional case where approximating a Hessian matrix is necessary, recent advances such as <a href="https://arxiv.org/abs/1503.05671">Kronecker-factored approximate curvature (KFAC)</a> make the Laplace approximation much more tractable to the point where it can be used in modern deep learning pipelines for general uncertainty estimation as it is in <a href="https://arxiv.org/abs/2106.14806">this recent paper</a>.</p>
<p>Beyond computational concerns, the underlying assumptions of the Laplace approximation may not be approriate for all problems. It is assumed that the true posterior is roughly Gaussian, but if it is in fact a heavily skewed Weibull distribution for example, then the approximated Gaussian will probably not be appropriate. Note too that the Laplace approximation puts the most emphasis on estimating the mode of the true distribution. If you are more interested in accurately capturing its variance instead, then other approximation techniques may be more appropriate.</p>
<p>The Laplace approximation is a simple but effective technique for approximating tricky posterior distributions. Though not perfect, it is nonetheless an important tool to have in the toolbox especially when working with Bayesian machine learning techniques. From the Napoleonic battlefield to the modern deep learning pipeline, it has continuously proved its usefulness.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{{ "This example can be found on pg 215 <em>Pattern Recognition and Machine Learning</em> by Christopher Bishop" | fndetail: 1 }}</p>

</div>
</div>
</div>
</div>
 

