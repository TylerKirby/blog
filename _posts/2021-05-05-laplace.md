---
keywords: fastai
description: Bayesian machine learning often requires working with posterior distributions that have no known closed form. There are plenty of approximation methods that exist, though they tend to be quite complex. This post provides an overview of the Laplace Approximation, an exceptionally simple approach that is seeing a resurgence in recent deep learning papers.
title: Laplace Approximation
toc: true
comments: true
categories: [machine_learning]
nb_path: _notebooks/2021-05-05-laplace.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2021-05-05-laplace.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Deep neural networks continue to solve problems that seemed out of reach of machine learning everyday. They offer unprecedented ability to generalize on high dimensional non-linear data and show promise in applications as far reaching as self-driving cars and automated radiological analysis. But as they are applied to high stakes problems like driving on the freeway and medical prognosis, limitations inherit to traditional deep learning algorithms like the inability to compute meaningful confidence scores easily and in a principled way become more clear. Bayesian neural networks seek to redress this by using proven probability methods to quantify uncertainty associated with inference. Unfortunately, these methods are usually much more mathematically complex and computationally intensive since they require working directly with continuous probability distributions. Recent research, however, has shown promising results by applying simpler techniques to modern neural networks like the Neurips 2021 paper, Laplace Redux - Effortless Bayesian Deep Learning, that utilizes the Laplace Approximation for fast and easy uncertainty estimates. This particular paper caught my eye since the Laplace Approximation was one of my favorite topics in graduate school. Most techniques for approximating posteriors are quite laborious and mathematically dense, but the Laplace Approximation is elegant in its simplicity and has found wide usage in standard implementations of key algorithms like Gaussian Process Classification. In this post I’ll review what the Neurips paper assumes the reader knows - why we need to approximate posteriors, how the Laplace Approximation generally works, and the importance of carefully implementations. The Laplace Approximation is an invaluable tool in the Bayesian toolbox and with this new paper it has become even more so.</p>
<h2 id="Problematic-Posteriors">Problematic Posteriors<a class="anchor-link" href="#Problematic-Posteriors"> </a></h2><p>To better appreciate the utility of the Laplace Approximation, let’s consider some instances where it can be useful. Suppose we would like to use logistic regression in an instance where uncertainty estimates are crucial, e.g., a binary classifier of radiological data that determines whether a tumor is benign or cancerous. A positive result indicating that a tumor is in fact cancerous is a serious affair, so we should have an understanding as to how certain we are about the prognosis. We can use Bayes’ Theorem to formulate the problem appropriately. Logistic regression is a parametric model for classification, so our prior belief should relate to the weights and our likelihood should define the relationship between the inputs and outputs of our model. A reasonable prior belief for our weights is that they are Gaussian distributed. Since this is a binary classification problem, we want to constrain our output space to just 0 and 1 which means that both Bernoulli and Binomial distributions are candidates for our likelihood. No matter our choice, however, our posterior belief will be intractable since Gaussian priors are not conjugate with either Bernoulli or Binomial distributions.</p>
<p>Suppose that after feeding our data to this logistic model we draw samples from the posterior which looks like this:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0, 0.5, &#39;Probability&#39;)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The true closed form solution for the posterior above is {% fn 1 %}</p>
$$
p(z) = \exp(\frac{-z^2}{2}) \cdot (1 + \exp(-z))^{-1}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{{ This example can be found on pg 215 <em>Pattern Recognition and Machine Learning</em> by Christopher Bishop | fndetail: 1 }}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Unfortunately we will very rarely have direct access to the closed form solution for the posterior, so we must approximate. Enter: Pierre-Simon Laplace.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="A-Solution-from-Parisian-Dice-Parlors">A Solution from Parisian Dice Parlors<a class="anchor-link" href="#A-Solution-from-Parisian-Dice-Parlors"> </a></h2><p>The Marquis de Laplace was a busy man. From his service to one Napoleon Bonaparte to his time frequenting gambling dens, there was no shortage of opportunities where Laplace needing to estimate the odds of an event. His contributions to the field of probability are almost unmatched: he rigorously formulated and popularized Bayes' Theorem, discovered probability generating functions, tied the least squares method to probability, and proved the central limit theorem which underpins the fields of statistics and probability today. But we are mostly concerned with a method developed in his 1774 manuscript <em>Mémoires de Mathématique et de Physique</em>.</p>
<h3 id="Deriving-the-Laplace-Approximation">Deriving the Laplace Approximation<a class="anchor-link" href="#Deriving-the-Laplace-Approximation"> </a></h3><p>The Laplace Approximation is a very general method for working with integrals of the form
$$
\int^a_b \exp(M \cdot f(x)) dx
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where $M$ is some large number and $f(x)$ is at least twice differentiable.</p>
<p>The basic idea is that we can use a Taylor series around the global maximum of the function as an approximation of the original intractable integral. Suppose that $f(x)$ has a global maximum around $x_0$ and that $x_0$ is not an endpoint. Then, using the first few terms of the Taylor series we have</p>
$$
f(x) = f(x_0) + f'(x_0)(x-x_0) + \frac{1}{2}f''(x_0)(x-x_0)^2
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Knowing that $f(x_0)$ is a global maximum allows us to simplify a bit further since $f'(x_0)$ should be 0.</p>
$$
f(x) \approx f(x_0) - \frac{1}{2}|f''(x_0)|(x-x_0)^2
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we plug this back into our original integral equation we have
$$
\int^a_b \exp(M \cdot f(x)) dx \approx \int^a_b \exp(M \cdot f(x_0) - \frac{1}{2}|f''(x_0)|(x-x_0)^2) dx
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which further simplifies to
$$
\exp(M f(x_0)) \cdot \int^a_b \exp(- \frac{1}{2}|f''(x_0)|(x-x_0)^2) dx
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall that the Gaussian integral has the form</p>
$$
\int \exp(-x)^2 dx = \sqrt{pi}
$$<p>so assuming that the integral we're interested in is an indefinite integral as is the case with most probability density functions then the Laplace Approximation allows us to use the Gaussian integral as an approximation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="A-Simple-Application">A Simple Application<a class="anchor-link" href="#A-Simple-Application"> </a></h3><p>As a brief aside, let's consider an application of the Laplace Approximation to a computer science problem. Suppose you wished to write a program to quickly compute $f(n) = n!$. Factorial equations are used all throughout physics, probability, and mathematics with practical uses in computing Bézier curves for computer graphics and time complexity equations for sorting algorithms.</p>
<p>A naive solution may look like</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">factorial</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we needed to run this function on very large integers thousands of times a second which may often be the case esperically in computer graphics, then we need this code to be especially fast. Multiplying increasing large integers in a for loop will probably become a bottleneck rather quickly, so this is a good opportunity to apply an approximation. Let's begin with the similar and useful Gamma function:</p>
$$
\Gamma(n) = (n-1)! = \int_0^{\infty} \exp(-x) x^{n-1} dx
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our factorial equation can then be written as</p>
$$
n! = \Gamma(n + 1) = \int_0^{\infty} \exp(-x)x^ndx
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By performing a change of variables so that $x = nz$ and $dx = n dz$ we can derive the following</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
= \int_0^{\infty}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>which further simplifies to
$$
\exp(M f(x_0)) \cdot \int^a_b \exp(- \frac{1}{2}|f''(x_0)|(x-x_0)^2) dx
$$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Recall that the Gaussian integral has the form</p>
$$
\int \exp(-x)^2 dx = \sqrt{pi}
$$<p>so assuming that the integral we're interested in is an indefinite integral as is the case with most probability density functions then the Laplace Approximation allows us to use the Gaussian integral as an approximation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="A-Simple-Application">A Simple Application<a class="anchor-link" href="#A-Simple-Application"> </a></h3><p>As a brief aside, let's consider an application of the Laplace Approximation to a computer science problem. Suppose you wished to write a program to quickly compute $f(n) = n!$. Factorial equations are used all throughout physics, probability, and mathematics with practical uses in computing Bézier curves for computer graphics and time complexity equations for sorting algorithms.</p>
<p>A naive solution may look like</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">result</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">result</span> <span class="o">*=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">result</span>

<span class="n">factorial</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1307674368000</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>If we needed to run this function on very large integers thousands of times a second which may often be the case esperically in computer graphics, then we need this code to be especially fast. Multiplying increasing large integers in a for loop will probably become a bottleneck rather quickly, so this is a good opportunity to apply an approximation. Let's begin with the similar and useful Gamma function:</p>
$$
\Gamma(n) = (n-1)! = \int_0^{\infty} \exp(-x) x^{n-1} dx
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our factorial equation can then be written as</p>
$$
n! = \Gamma(n + 1) = \int_0^{\infty} \exp(-x)x^ndx
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>By performing a change of variables so that $x = nz$ and $dx = n dz$ we can derive the following</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
$$
= \int_0^{\infty}
$$
</div>
</div>
</div>
</div>
 

